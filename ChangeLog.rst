Changelog
=========


v0.0.3 (2021-08-20)
-------------------

New
~~~
- Add issue/PR templates and base .gitignore file. [Stephen L Arnold]

Changes
~~~~~~~
- Add pkconfig.in file, update configure.ac. [Stephen L Arnold]
- Add readme section for overlay/ppa package installs. [Stephen L
  Arnold]

Other
~~~~~
- Test conversion and display of coverity results as SARIF data.
  [Stephen L Arnold]
- Cpplint cleanup and workflow (#8) [Steve Arnold]

  * add doctest to pylint workflow, with minimal nose cfg
  * cpplint cleanup commit, mainly whitespace, if/else, and curly braces
  * cleanup indenting, revert if/else brace changes, add cfg file
  * fix constructor warnings in inc/json.hh, add cpplint worklow
- Revert action to @main and set branch for metrics. [Stephen L Arnold]
- Use new action release and set source directories for analysis.
  [Stephen L Arnold]
- Silence "/tmp" path socket warning with a usage comment. [Stephen L
  Arnold]
- Add pylint workflow (check only, fail under 9.25) [Stephen L Arnold]
- More fun with badges. [Stephen L Arnold]
- Add bandit workflow (with github annotaions), disable flake8 ignores.
  [Stephen L Arnold]
- Update readme status, use status table. [Stephen L Arnold]
- Add codeql analysis to its own workflow, enable extra queries.
  [Stephen L Arnold]
- Add python examples to readme (doctest-able even) [Stephen L Arnold]
- Pylint cleanup commit, update pep8speaks config. [Stephen L Arnold]
- Flake8 cleanup commit, add modified gitchangelog.rc and flake8 cfg.
  [Stephen L Arnold]


v0.0.2 (2021-07-23)
-------------------
- Switch build status badge to (internal) github actions. [Stephen L
  Arnold]
- Test alternate github license provider 2. [Stephen L Arnold]
- Update license (filename) to GPL-2.0 generated by github. [Stephen L
  Arnold]
- Add status badges to readme file (#4) [Steve Arnold]

  * add status badges to readme file
  * fix license file parsing (on github) and add SPDX id to primary sources
- Make gettid() conditional on glibc version. [Stephen L Arnold]
- Add project-level codecov config file. [Stephen L Arnold]
- Separate src prepare from src configure, display coverage in CI.
  [Stephen L Arnold]
- Enable coverage with html default report, add to smoke workflow.
  [Stephen L Arnold]
- Fix gcc build error and remove obsolete json-c usage. [Stephen L
  Arnold]
- Add github CI and test across ubuntu/toolchain versions. [Stephen L
  Arnold]
- Ditch extraneous header file from python branch. [S. Lockwood-Childs]
- Some redis-py fixes in python module. [S. Lockwood-Childs]

  * redis.Connection is for tcp connections, not unix sockets,
    use redis.StrictRedis instead

  * blpop() returns None on timeout or (queue, value) if successful in
    popping value from queue
- Debug fix properly access globals. [nll]
- Deleted bogus comma. [nll]
- This is a version ready to be tested it is not checked out. [nll]
- Add server-side class to python module. [S. Lockwood-Childs]

  client-side class has one public method
    redis_ipc_send_and_receive()

  but server-side class has two
    redis_ipc_receive_command()
    redis_ipc_send_reply()

  because server has to do some processing between getting a command
  and sending back a reply
- C library encodes tid as integer, so match in python module. [S.
  Lockwood-Childs]
- Python module is really close to client-side functionality. [S.
  Lockwood-Childs]

  "client-side" means the code that generates commands and receives
  replies, as opposed to "server-side" code that waits for commands
  and services them.

  python now follows C-library conventions so it should (soon) interoperate
  with a server app written in C:

  * same mandatory fields for commands

    cmd["timestamp"]
    cmd["component"]
    cmd["thread"]
    cmd["tid"]
    cmd["results_queue"]
    cmd["command_id"]

  * same naming of queues for commands and their replies

    * command queue in format "queues.commands.$SERVER_COMPONENT"

    * reply queue in format "queues.results.$CLIENT_COMPONENT.$CLIENT_THREAD"

  TODO:

  Still need to fill in the actual redis connection bits,
  plus generate real timestamps for commands
- This version can do a few things it thinks it can send and receive
  messages, but it can not those functions are stubs the file can be
  imported into Python the code is written to raise exceptions, but none
  are handled yet no logging is performed. [nll]
- New version of skeleton and a tiny bit of meat. [nll]
- A little more client code for redis. [nll]
- A little more client code. [nll]
- Skeleton of redis client. [nll]
- A file was added proclaiming the vital features of the client library
  to implement in Python as a first phase no comment on what a new phase
  might bring. [nll]
- Redis_ipc.h: explicitly declare init/cleanup functions. [Steve Arnold]

  Fixes QA warnings about implicit declarations.


v0.0.1 (2017-03-11)
-------------------
- Make debian packaging straight from git work. [S. Lockwood-Childs]

  alternative is to do 'make dist' and use that as upstream tarball,
  either way should work...
- Fix date stamp in debian/copyright file. [Steve Arnold]
- Tweak debian/ubuntu packaging so it should work. [S. Lockwood-Childs]
- Add readme for example programs. [S. Lockwood-Childs]
- Add initial debian packaging files (still untested) [Steve Arnold]
- "tests" were more examples than tests, for now count running as
  "passed" [S. Lockwood-Childs]
- Cleanup cruft, need to test with running redis server. [Steve Arnold]
- Building lib and test programs works; custom test runner tweaks still
  needed. [Steve Arnold]
- Working libtool shared library build (no tests yet, so still a WIP)
  [Steve Arnold]

  Still not sure if that's what we want...
- Not quite working - WIP. [Steve Arnold]
- Make new autotools baseline, move to subdirs, add Makefile.am and
  configure.ac, populate initial GPL files. [Steve Arnold]


v0.0.0 (2017-03-10)
-------------------
- Fix build against current json-c paths and names. [Steve Arnold]
- Still filling holes in README doc. [Stephanie Lockwood-Childs]
- Another README formatting tweakage. [Stephanie Lockwood-Childs]
- README formatting fixes. [Stephanie Lockwood-Childs]
- Putting documentation README. [Stephanie Lockwood-Childs]

  Still a work in progress, some sections missing...
- Connect to unix socket instead of localhost tcp. [Stephanie Lockwood-
  Childs]

  Unix sockets are better for performance (and security, since permissions
  can constrain what clients use the socket) than localhost tcp
  connections, so a hard-coded path of /tmp/redis-ipc/socket replaces the old
  localhost & port in the category of things-that-probably-belong-in-a-config
- Provide sample output file for each test prog. [Stephanie Lockwood-
  Childs]
- Fix crashes after failing to connect to redis server. [Stephanie
  Lockwood-Childs]
- Support 'make testprogs' [Stephanie Lockwood-Childs]
- Test program cleanup. [Stephanie Lockwood-Childs]

  test.c was a dupe, json_test can now be built from Makefile
- Native build should be default. [Stephanie Lockwood-Childs]

  When cross-compiling, set CROSS_COMPILE and SYSROOT. Skip setting
  them for native compiles.
- Just a couple more debug messages. [Stephanie Lockwood-Childs]

  Helped with debugging an app crash when a field was missing from redis
- Added GNU hash to linker args. [Stephen Arnold]
- Update makefile and added missing includes to test source files.
  [Stephen Arnold]
- Switched to thread-local storage. [Stephanie Lockwood-Childs]

  Discovered that arm compiler should support __thread variables, so was
  able to switch per-thread struct to thread-local without having to roll
  my own via different entries in a list.

  Multi-thread test program which would segfault about 1 in 3 times (due to the
  threads stomping on each other) now succeeded 100 times in a row.
- Make header C++ safe. [Stephanie Lockwood-Childs]

  use ifdef's to insert 'extern C' block in header when compiled under C++
- Added wrapper class for json-c access from C++ [Stephanie Lockwood-
  Childs]

  json-c brings with it the typical reference-tracking pain of
  dynamically allocated C objects, but redis_ipc uses it anyway
  to provide C compatibility. This wrapper class is intended
  to make use of a returned json_object * much less painful for
  applications that are written in C++ instead.
- Fix segfault after redis connection error. [Stephanie Lockwood-Childs]
- Fix single-field read of settings/status hashes. [Stephanie Lockwood-
  Childs]

  Return value was pointing to stuff that was going out of scope, so
  needed to stdup() a copy. Made note in the .h that, as usual, caller
  is responsible for cleanup when done with returned value.
- Add targets for test programs and install. [Stephanie Lockwood-Childs]
- Implemented single-field hash operations. [Stephanie Lockwood-Childs]

  Single-field versions of setting and status hash operations
  seem to be working now.
- Setting hash read/write implemented. [Stephanie Lockwood-Childs]

  Successfully performed setting write and read back with test
  program. Currently library is looking for component "db" as
  the one privileged to update settings, but that probably isn't
  the right name.

  Still need to implement single-field operations for both status
  and setting hashes.
- Status hash read/write implemented. [Stephanie Lockwood-Childs]

  Successfully performed status write and read back with test program.

  While adding hash support, discovered that redis syntax errors do not
  result in NULL replies but rather REDIS_REPLY_ERROR type replies,
  so redis reply checking had to be reworked accordingly.
- Pairing of command and result. [Stephanie Lockwood-Childs]

  After sending a command, the submitter will now discard result entries
  that do not have a matching ID and keep looking for the one that belongs
  to the just-submitted command.
- Send command and receive result almost works. [Stephanie Lockwood-
  Childs]

  Command processing is close to finished: one process can queue a
  command, and another process can receive and send back a result.

  Still need to put in the check to see that a received reply matches
  the recently-sent command (compare the command id strings).
- Queueing commands. [Stephanie Lockwood-Childs]

  The first half of sending commands has been implemented and exercised
  with test program. The command is being properly formatted and pushed to
  a redis queue, but parsing the result still needs to be filled out.

  Also cleaned up internal func ipc_path() to be less redundant.
- Cleanup func. [Stephanie Lockwood-Childs]

  Implemented cleanup func, though will need to revisit both init and
  cleanup to make them work with multi-thread processes (switch to a
  list of per-thread structs for saving state, as noted in FIXMEs).
- Subscribers can listen on channels. [Stephanie Lockwood-Childs]

  Finished up initial cut at pub/sub API by implementing the blocking
  listener function. Caller is responsible for not trying to listen
  until one or more channels have been subscribed, though library
  could track subscriptions if that became a problem.

  Test program is now able to post messages from one process and
  receive them from another.
- Implement subscribe/unsubscribe. [Stephanie Lockwood-Childs]

  Implemented functions for subscribe/unsubscribe from event or debug
  channels. The correct redis commands appear to be sent by the test
  program, and further verification awaits implementation of receiving
  published events/debug messages.
- Implement sending of events. [Stephanie Lockwood-Childs]

  events can now be published on redis
- Added timestamps to debug. [Stephanie Lockwood-Childs]
- Debug channel is working. [Stephanie Lockwood-Childs]

  Haven't implemented timestamp field for debug messages yet,
  but other than that debug messages are working -- JSON message
  looks correct and gets sent to redis pub/sub channel.
- Implementing init and send-debug funcs. [Stephanie Lockwood-Childs]

  Init function seems to work, debug function is mostly there -- generates
  json text, but prints to stdout instead of really publishing to redis.
- Starting library implementation. [Stephanie Lockwood-Childs]

  Started implementing functions. Init and send-debug functions are mostly
  implemented and compile now (not run-tested yet)
- Initial design but not implementation. [Stephanie Lockwood-Childs]

  Library include file has proposed function signatures

  None of the functions have been implemented yet however
